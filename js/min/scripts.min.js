$(function(){function a(){var a="edit-warning";if(0==$("."+a).length){var b="<p>Editing the XPath will disable all options including the selection table and the tree representation. Furthermore, you will <strong>not</strong> be able to select SoNaR as the corpus of interest.</p><p><strong>Only edit this code if you know what you are doing!</strong></p>";b+="<small>You can re-enable all options and reset XPath to the last unmodified structure by pressing the button <em>Reset XPath</em></small>",g(b,!0,a)}var c=$("."+a),d=c.data("popup-id");Cookies.get("popup-continue-"+d)?($(".input-wrapper, .xpath-wrapper > div:first-child, #tree-output, .guidelines").addClass("advanced-mode-active").find(":not(.disabled) > input, :not(.disabled) > button").prop("disabled",!0),$('[name="manualMode"]').val("true"),$(".continue-btn-wrapper [type='submit']").prop("disabled",!1),$(".xpath-wrapper textarea").off("mousedown")):(h(c,$("#xpath")),c.find("button.continue").click(function(){$(".input-wrapper, .xpath-wrapper > div:first-child, #tree-output, .guidelines").addClass("advanced-mode-active").find(":not(.disabled) > input, :not(.disabled) > button").prop("disabled",!0),$('[name="manualMode"]').val("true"),$(".continue-btn-wrapper [type='submit']").prop("disabled",!1),$(".xpath-wrapper textarea").off("mousedown")}))}function b(){$("body:not(.treebanks) .help-tooltip[data-title]").each(function(a,b){var c=$(b),d=b.getBoundingClientRect(),e=n.width(),f=n.height();c.addClass("hang-right hang-left hang-bottom hang-top"),(e-d.right<=320||d.top<=160||f-d.bottom<=160)&&c.removeClass("hang-right"),(d.left<=320||d.top<=160||f-d.bottom<=160)&&c.removeClass("hang-left"),(f-d.bottom<=320||e-d.right<=160||d.left<=160)&&c.removeClass("hang-bottom"),(d.top<=320||e-d.right<=160||d.left<=160)&&c.removeClass("hang-top")})}function c(a,b){$.ajax({type:"POST",url:"http://bramvanroy.be/projects/xpath-beautifier/php/receive-post.php",crossDomain:!0,data:a,headers:{"cache-control":"no-cache"},xhrFields:{withCredentials:!0}}).done(function(a){}).fail(function(a,b,c){}).always(function(){var a=window.open(b,"_blank");a?a.focus():alert("Your browser blocked opening a new window. Please allow pop-ups for this website. We will never show advertisements.")})}function d(){n.width()<721?(m.addClass("small"),m.find("button").addClass("active")):(m.removeClass("active small"),m.find("button").removeClass("active"))}function e(){r&&r.abort(),$(".continue-btn-wrapper [type='submit']").prop("disabled",!0),r=$.ajax({url:getTreePathScript,method:"POST",data:$("main form").serialize()}).done(function(a){var b=$.parseJSON(a);b.location&&$("#tree-output").treeVisualizer(b.location,{extendedPOS:!0}),b.xpath&&($("#xpath, .xpath-wrapper input[name='originalXp']").val(b.xpath),f($("#xpath"))),$(".continue-btn-wrapper [type='submit']").prop("disabled",!1)})}function f(a){a.height(0).outerHeight(a[0].scrollHeight+2)}function g(a,b,c){for(var d=1;;){if(!$("[data-popup-id='"+d+"'").length){var e=document.createElement("aside");$(e).html(a).attr({"data-popup-id":d,class:"popup"}).hide().appendTo("#popup-wrapper"),$(e).append('<div class="btn-wrapper"><button title="Continue editing XPath" type="button" class="continue">Continue</button></div>'),b&&$(e).children(".btn-wrapper").prepend('<button title="Close this pop-up" type="button" class="cancel">Cancel</button>'),c&&$(e).addClass(c);break}d++}if(0==$("#popup-overlay").length){var f=document.createElement("div");$(f).attr("id","popup-overlay").hide().appendTo("#popup-wrapper")}}function h(a,b){a.css({visibility:"hidden",display:"block"});var c=n.width(),d=n.height(),e=b[0].getBoundingClientRect(),f=b.offset(),g=c-e.right,h=d-e.bottom,i=a[0].getBoundingClientRect(),j=(e.width-i.width)/2,k=(e.height-i.height)/2,l=16;a.removeClass("hang-right hang-left hang-bottom hang-top"),e.top>i.height+l&&g>i.width/2&&e.left>i.width/2?(a.addClass("hang-top"),a.css({left:f.left+j,top:f.top-i.height-l})):e.left>i.width+l&&e.top>i.height/2&&h>i.height/2?(a.addClass("hang-left"),a.css({left:f.left-i.width-l,top:f.top+k})):g>i.width+l&&e.top>i.height/2&&h>i.height/2?(a.addClass("hang-right"),a.css({left:f.left+e.width+l,top:f.top+k})):(a.addClass("hang-bottom"),a.css({left:f.left+j,top:f.top+e.height+l})),a.css("visibility","visible"),$("#popup-overlay").show()}function i(a){a.fadeOut("fast"),$("#popup-overlay").hide()}function j(){if(k().tpinput){var a=decodeURIComponent(k().tpinput);$(".step-1 .input-wrapper input").val(a),$(".step-1 textarea[name=xpath]").val(a)}}function k(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}var l=$("body"),m=$(".primary-navigation"),n=$(window),o=$(document);if($("#old-ie-script").remove(),n.resize($.throttle(500,function(){d(),b()})).resize(),n.scroll($.throttle(700,b)).scroll(),$("#popup-wrapper").on("click","button.cancel, button.continue",function(){var a=$(this),b=a.closest(".popup"),c=b.data("popup-id");a.hasClass("continue")&&Cookies.set("popup-continue-"+c,"true"),i(b)}),$("[data-collapse-btn]").wrap('<a href="#" class="collapse" data-collapse="visible" title="Show or hide this section" />').after('<span class="btn-wrapper"><i class="fa fa-fw fa-angle-up" aria-hidden="true"></i><span class="sr-only">Show or hide this section</span></span>'),$("[name='to-top']").click(function(){$("html, body").animate({scrollTop:0})}),$('a[href^="#"]').click(function(a){$(this).is('[href^="#"]')&&(document.location.hash=$(this).attr("href").substring(1),a.preventDefault())}),$("a.collapse").off().click(function(a){var b=$(this);"hidden"==b.attr("data-collapse")?(b.attr("data-collapse","visible"),b.next("[data-collapse-target]").show()):(b.attr("data-collapse","hidden"),b.next("[data-collapse-target]").hide()),a.preventDefault()}),$("body.docs a.collapse").click(),l.hasClass("docs")&&window.location.hash&&$(window.location.hash).parent("a").click(),$("body.matrix .xpath-wrapper a, body.xps.input .open-beautifier-wrapper a").click(function(a){a.preventDefault();var b=$(this).attr("href");c($("#xpath").serialize(),b)}),m.find("button").click(function(){m.toggleClass("active")}),o.click(function(a){m.hasClass("active")&&($(a.target).closest(m.find("button"),m.find("ul")).length||m.removeClass("active"))}),l.hasClass("input")){var p=$("[name='clear']");if(p.click(function(a){var b=$(this);b.prev("[name='input'], textarea").val("").addClass("no-content").focus(),b.prop("disabled",!0),a.preventDefault()}),$("[name='input'], textarea").keyup(function(){var a=$(this);a.val()?(a.removeClass("no-content"),p.prop("disabled",!1)):(a.addClass("no-content"),p.prop("disabled",!0))}).keyup(),j(),l.hasClass("xps")){var q=$("[name='xpath']");$("[type='submit']").click(function(){var a=(q.val().match(/\[/g)||"").length,b=(q.val().match(/\]/g)||"").length;a==b?q[0].setCustomValidity(""):(a>b&&q[0].setCustomValidity("Fix XPath inconsistency: missing ] or unnecessary [ (x"+(a-b)+")"),a<b&&q[0].setCustomValidity("Fix XPath inconsistency: missing [ or unnecessary ] (x"+(b-a)+")"))}),q.keyup(function(){this.setCustomValidity("")})}}else if(l.hasClass("matrix")){var q=$("[name='xpath']");$("[type='submit']").click(function(){var a=(q.val().match(/\[/g)||"").length,b=(q.val().match(/\]/g)||"").length;a==b?q[0].setCustomValidity(""):(a>b&&q[0].setCustomValidity("Fix XPath inconsistency: missing ] or unnecessary [ (x"+(a-b)+")"),a<b&&q[0].setCustomValidity("Fix XPath inconsistency: missing [ or unnecessary ] (x"+(b-a)+")"))}),q.keyup(function(){this.setCustomValidity("")});var r;e(),$("main form input[type='radio'], main form input[type='checkbox']:not([name='ct'])").change(function(){e()}),$("form").submit(e()),$("tbody td").click(function(){$(this).find("input").click()}).find("input").click(function(a){a.stopPropagation()}),$(".table-wrapper .case-sensitive input[type='checkbox']").each(function(a,b){var c=$(b);c.is(":checked")&&c.prop("disabled",!1).parent("td:not(.punctuation)").removeClass("disabled")}),$(".table-wrapper input[type='radio']").click(function(){var a=$(this),b=a.parent("td:not(.punctuation)"),c=$(".table-wrapper .case-sensitive td:nth-child("+(b.index()+1)+")");b.length&&("token"==a.val()?c.removeClass("disabled").children("input[type='checkbox']").prop("disabled",!1):c.addClass("disabled").children("input[type='checkbox']").prop("checked",!1).prop("disabled",!0))});var s=$(".advanced-btn-wrapper button"),t=$(".table-wrapper tr.advanced-option");s.click(function(){$(".advanced-option:not(tr)").toggle(),t.toggleClass("visible-row");var a;t.hasClass("visible-row")?(a="Hide advanced options",f($("#xpath")),b()):a="Show advanced options",s.attr("title",a).children("span").text(a)}),$(".xpath-wrapper input[type='reset']").click(function(b){b.preventDefault(),$("#xpath").val($(".xpath-wrapper input[name='originalXp']").val()).change(),$(".input-wrapper, .xpath-wrapper > div:first-child, #tree-output, .guidelines").removeClass("advanced-mode-active").find(":not(.disabled) > input, :not(.disabled) > button").prop("disabled",!1),$('[name="manualMode"]').val("false"),$(".xpath-wrapper textarea").on("mousedown",a)}),$(".xpath-wrapper textarea").on("mousedown",a)}else l.hasClass("treebanks")&&($("[type='radio']").change(function(){var a=$(this),b=a.val();a.is("[name='treebank']")&&($(".cgn, .lassy, .sonar").hide().removeClass("active"),$(".cgn, .lassy, .sonar").find("[type='checkbox'], [type='radio']").prop("disabled",!0),$("."+b).show().addClass("active").find("label:not(.disabled)").find("[type='checkbox'], [type='radio']").prop("disabled",!1),"sonar"!=b&&0==$("."+b+" [type='checkbox']:checked").length?$(".continue-btn-wrapper [type='submit']").prop("disabled",!0):$(".continue-btn-wrapper [type='submit']").prop("disabled",!1))}),$("[type='checkbox']").change(function(){var a=$(this);if(this.setCustomValidity(""),a.is("[data-check^='all']")){var b=a.prop("checked");b?$(".continue-btn-wrapper [type='submit']").prop("disabled",!1):$(".continue-btn-wrapper [type='submit']").prop("disabled",!0),a.is("[data-check='all-cgn-vl']")?$(".cgn label:not(.disabled) [type='checkbox'][value^='v']").prop("checked",b):a.is("[data-check='all-cgn-nl']")?$(".cgn label:not(.disabled) [type='checkbox'][value^='n']").prop("checked",b):$(".lassy label:not(.disabled) [type='checkbox']").prop("checked",b)}else if(a.is("[name='subtreebank[]']")){var c,d=a.attr("data-treebank"),e=a.closest(".table-wrapper"),f=a.val(),g=f.substring(0,1);c="n"==g?e.find("[data-check='all-cgn-nl']"):"v"==g?e.find("[data-check='all-cgn-vl']"):e.find("[data-check='all-lassy']");var h=e.find("[name='subtreebank[]']"),i="cgn"==d?"[value^='"+g+"']":"";h.filter(i+":not(:disabled)").length==h.filter(i+":not(:disabled):checked").length?(c.prop("indeterminate",!1),c.prop("checked",!0)):0==h.filter(i+":checked").length?(c.prop("indeterminate",!1),c.prop("checked",!1)):c.prop("indeterminate",!0)}$("div.active .table-wrapper [type='checkbox']:checked").length>0?$(".continue-btn-wrapper [type='submit']").prop("disabled",!1):$(".continue-btn-wrapper [type='submit']").prop("disabled",!0)}),0==$("[type='radio'][name='treebank']:checked").length?$("[type='radio'][name='treebank'][value='lassy']").click().change():$("[type='radio'][name='treebank']:checked").click().change())});