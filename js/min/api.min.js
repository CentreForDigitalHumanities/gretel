function updateQueryStringParameter(a,b,c){c||(c=window.location.href);var d,e=new RegExp("([?&])"+a+"=.*?(&|#|$)(.*)","gi");if(e.test(c))return void 0!==b&&null!==b?c.replace(e,"$1"+a+"="+b+"$2$3"):(d=c.split("#"),c=d[0].replace(e,"$1$3").replace(/(&|\?)$/,""),void 0!==d[1]&&null!==d[1]&&(c+="#"+d[1]),c);if(void 0!==b&&null!==b){var f=-1!==c.indexOf("?")?"&":"?";return d=c.split("#"),c=d[0]+f+a+"="+b,void 0!==d[1]&&null!==d[1]&&(c+="#"+d[1]),c}return c}function getParameterByName(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}$(function(){$(".facet input.facet-daterange").each(function(){function a(a,b){return a<b?a:b}function b(a,b){return a>b?a:b}$(this).css("max-width","100px");var c=$(this).attr("name").split("_")[0],d=$(this).attr("name").split("_")[1],e=getParameterByName(c),f=new Date(Date.parse($(this).attr("data-min"))),g=new Date(Date.parse($(this).attr("data-max"))),h=f,i=g;if(e&&2===e.split("*").length){var h=new Date(Date.parse(e.split("*")[0])),i=new Date(Date.parse(e.split("*")[1]));a(f,h),b(g,i)}$(this).datepicker({minDate:f,maxDate:g,changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd"}).on("change",function(){var a="";a="from"===d?$(this).val()+"*"+$(this).next().val():$(this).prev().val()+"*"+$(this).val(),window.location=updateQueryStringParameter(c,a)}),"from"===$(this).attr("name").split("_")[1]&&$(this).datepicker("setDate",h),"to"===$(this).attr("name").split("_")[1]&&$(this).datepicker("setDate",i)}),$(".facet input.facet-range").each(function(){var a,b,c=$(this).attr("name"),d=getParameterByName(c),e=+$(this).attr("data-min"),f=+$(this).attr("data-max");d?(a=+d.split("*")[0],b=+d.split("*")[1]):(a=e,b=f),$(this).val(a+" - "+b),$(this).next().slider({range:!0,min:e,max:f,values:[a,b],slide:function(a,b){$(this).prev().val(b.values[0]+" - "+b.values[1])},stop:function(a,b){var d=b.values[0]+"*"+b.values[1];window.location=updateQueryStringParameter(c,d)}})}),$(".facet select").each(function(){var a=$(this).attr("name");$(this).val(getParameterByName(a))}),$(".facet select").on("change",function(){var a,b=$(this).attr("name"),c=$(this).val();a=c?updateQueryStringParameter(b,c):updateQueryStringParameter(b),window.location=a}),$(".facet input.facet-value").each(function(){var a=$(this).parents("div.facet").attr("id"),b=$(this).attr("name"),c=getParameterByName(a);$(this).prop("checked",c===b)}),$(".facet input.facet-value").click(function(){var a,b=$(this).parents("div.facet").attr("id"),c=$(this).attr("name");a=this.checked?updateQueryStringParameter(b,c):updateQueryStringParameter(b),window.location=a}),$(".export").click(function(){var a=window.location.href.replace("ebs/results.php","scripts/SaveResults.php");a=updateQueryStringParameter("print",$(this).attr("data-format"),a),window.open(a)})}),$(function(){$.getJSON(API+"/treebank",function(a){$.each(a,function(a,b){var c=$('<input type="radio" name="treebank" />').attr("id",b.title).attr("value",b.title).appendTo(".labels-wrapper");c.wrap('<label for="'+b.title+'"></label>'),c.after(" <strong>"+b.title+"</strong>"),c.parent().wrap('<div class="label-wrapper"></div>')})}),$(".labels-wrapper").on("click",'input[name="treebank"]',function(){var a=$(this).val();$.getJSON(API+"/treebank/show/"+a,function(b){$(".corpora-wrapper").empty();var c=$("<table>");c.append('<thead><tr><th><input type="checkbox" class="check-all" checked></th><th>Component</th><th>Contents</th><th>Sentences</th><th>Words</th></tr></thead>');var d=$("<tbody>");$.each(b,function(b,c){var e=$("<tr>"),f=$('<input type="checkbox" checked>').attr("data-treebank",a).attr("name","subtreebank[]").val(c.slug);e.append($("<td>").append(f)),$.each(c,function(a,b){"slug"===a||"title"===a?e.append($("<td>").text(b)):"nr_sentences"!==a&&"nr_words"!==a||e.append($("<td>").text(parseInt(b).toLocaleString()))}),d.append(e)}),c.append(d),$(".corpora-wrapper").append(c)})}),$(".corpora-wrapper").on("click",".check-all",function(){$(this).parents("table").find("tbody input").prop("checked",$(this).prop("checked"))})});